def char_to_keystrokes(ch):
	ret = []
	char_table = {'!': [[0, 71], [0, 19], [1, 19], [1, 71]],
                      '@': [[0, 71], [0, 20], [1, 20], [1, 71]],
                      '#': [[0, 71], [0, 21], [1, 21], [1, 71]],
                      '$': [[0, 71], [0, 22], [1, 22], [1, 71]],
                      '%': [[0, 71], [0, 23], [1, 23], [1, 71]],
                      '^': [[0, 71], [0, 24], [1, 24], [1, 71]],
                      '&': [[0, 71], [0, 25], [1, 25], [1, 71]],
                      '*': [[0, 71], [0, 26], [1, 26], [1, 71]],
                      '(': [[0, 71], [0, 27], [1, 27], [1, 71]],
                      ')': [[0, 71], [0, 18], [1, 18], [1, 71]],
                      '\'': [[0, 54], [1, 54]],
                      '"': [[0, 71], [0, 54], [1, 54], [1, 71]],
                      ',': [[0, 55], [1, 55]],
                      '<': [[0, 71], [0, 55], [1, 55], [1, 71]],
                      '.': [[0, 56], [1, 56]],
                      '>': [[0, 71], [0, 56], [1, 56], [1, 71]],
                      ';': [[0, 57], [1, 57]],
                      ':': [[0, 71], [0, 57], [1, 57], [1, 71]],
                      '=': [[0, 58], [1, 58]],
                      '+': [[0, 71], [0, 58], [1, 58], [1, 71]],
                      '/': [[0, 59], [1, 59]],
                      '?': [[0, 71], [0, 59], [1, 59], [1, 71]],
                      '\\': [[0, 60], [1, 60]],
                      '|': [[0, 71], [0, 60], [1, 60], [1, 71]],
                      ' ': [[0, 61], [1, 61]],
                      '[': [[0, 62], [1, 62]],
                      '{': [[0, 71], [0, 62], [1, 62], [1, 71]],
                      ']': [[0, 63], [1, 63]],
                      '}': [[0, 71], [0, 63], [1, 63], [1, 71]],
                      '-': [[0, 64], [1, 64]],
                      '_': [[0, 71], [0, 64], [1, 64], [1, 71]],
                      '`': [[0, 65], [1, 65]],
                      '~': [[0, 71], [0, 65], [1, 65], [1, 71]],
		      '\t': [[0, 66], [1, 66]],
                      '\n': [[0, 67], [1, 67]],
                      '\b': [[0, 68], [1, 68]]}
	if ord(ch) >= 65 and ord(ch) <= 90:
		# A-Z
		ret.append([0, 71])
		ret.append([0, ord(ch)-65+28])
		ret.append([1, ord(ch)-65+28])
		ret.append([1, 71])
	elif ord(ch) >= 97 and ord(ch) <= 122:
		# a-z
		ret.append([0, ord(ch)-97+28])
		ret.append([1, ord(ch)-97+28])
	elif ord(ch) >= 48 and ord(ch) <= 57:
		# 0-9
		ret.append([0, ord(ch)-48+18])
		ret.append([1, ord(ch)-48+18])
	else:
		try:
			ret = char_table[ch]
		except KeyError:
			raise Exception("Character '%c' not supported." % (ch))
	return ret

def specialchar_to_keystrokes(ch):
	ret = []
	char_table = {'b': [[0, 68], [1, 68]], # backspace
                      'e': [[0, 1], [1, 1]], # escape
                      'w': [[0, 102], [1, 102]], # winkey
                      'a': [[0, 73], [1, 73]], # alt
                      'u': [[0, 86], [1, 86]], # up
                      'd': [[0, 87], [1, 87]], # down
                      'l': [[0, 88], [1, 88]], # left
                      'r': [[0, 89], [1, 89]], # right
                      'U': [[0, 82], [1, 82]], # pg up
                      'D': [[0, 85], [1, 85]]} # pg down
	try:
		ret = char_table[ch]
	except KeyError:
		raise Exception("Character '%c' not supported." % (ch))
	return ret

def string_to_keystrokes(str):
	ret = []
	for ch in str:
		c = ch
		for stroke in char_to_keystrokes(ch):
			ret.append((c, stroke))
			c = None
	return ret

def emacs_to_keystrokes(str):
	ret = []
	emacs_table = {'C': [[0, 69], [1, 69]],
                       'A': [[0, 73], [1, 73]],
                       'Del': [[0, 83], [1, 83]],
                       'Up': [[0, 86], [1, 86]],
                       'Down': [[0, 87], [1, 87]],
                       'Left': [[0, 88], [1, 88]],
                       'Right': [[0, 89], [1, 89]],
                       'Esc': [[0, 1], [1, 1]],
                       'F1': [[0, 2], [1, 2]],
                       'F2': [[0, 3], [1, 3]],
                       'F3': [[0, 4], [1, 4]],
                       'F4': [[0, 5], [1, 5]],
                       'F5': [[0, 6], [1, 6]],
                       'F6': [[0, 7], [1, 7]],
                       'F7': [[0, 8], [1, 8]],
                       'F8': [[0, 9], [1, 9]],
                       'F9': [[0, 10], [1, 10]],
                       'F10': [[0, 11], [1, 11]],
                       'F11': [[0, 12], [1, 12]],
                       'F12': [[0, 13], [1, 13]],
                       'Enter': [[0, 67], [1, 67]]}
	try:
                strokes = emacs_table[str]
                for stroke in strokes:
                        ret.append(stroke)
	except KeyError:
                for a,b in string_to_keystrokes(str):
                        ret.append(b)
	return ret
